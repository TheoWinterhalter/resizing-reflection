\documentclass[a4paper,english]{lipics-utf8x}

\usepackage[T1]{fontenc} %

\usepackage{amsmath, amssymb, amsfonts, stmaryrd}
\usepackage{pifont}
\PrerenderUnicode{é} % For the author names in the heading

% Add some colors
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage{hyperref}
\hypersetup{
 linktocpage,
 colorlinks,
 citecolor=BlueViolet,
 filecolor=red,
 linkcolor=Blue,
 urlcolor=BrickRed
}

\usepackage{graphicx}
\usepackage{placeins}

% Meta comment
\newcommand\meta[1]{\noindent\textcolor{blue}{\emph{#1}}}

% Include the macro file
\input{macros}

% Title and so...
\title{Squash me to the Smallest Universe}
\author[1]{Théo Winterhalter}

\begin{document}

  \maketitle

  \begin{abstract}
    This time we propose a development of a squash lying in the smallest
    universe (or any universe for that matter).
  \end{abstract}

  \section{Syntax}

  \[
    \begin{array}{l@{~}l@{~}l@{~}r@{~}l@{\quad}l}
      \Var  & \ni & x,y,X,Y \\
      \Sort & \ni & s             & ::= & \Type_k \mbox{ }
                                                (k \in \mathbb{N}) \\
      \Exp  & \ni & t,u,T,U & ::= & s \mid \Pi x:U.T \mid \Sigma x:U.T \mid
                                    t =_T u \mid \squash{T} \\
                         &&& \mid & x \mid \lambda x:U.t \mid t~u
                               \mid (t;u) \mid t.1 \mid t.2 \mid \refl_t \mid
                               \J (T,U,t_{refl},u_1,u_2,t_{eq}) \\
                         &&& \mid & [t] \mid \elim(T,U,f,h,t) \\
      \Ctx  & \ni & \Gamma  & ::= & \cdot \mid \Gamma, x:T \\
    \end{array}
  \]

  \noindent %
  We write $A \to B$ as short for $\Pi \_:A.B$, the non-dependent product.
  We also write $=$ for $=_T$ when $T$ is understood.

  The \emph{novelty} here, with respect to MLTT, is the introduction of a squash
  $\squash{T}$ with an injection $[t]$ from $T$, all of its inhabitants being
  definitionally equal (which I believe is key). The only way to eliminate is
  in a (semantically) irrelevant context, \ie through something hProp.
  This will be translated by $\elim$.
  Basically $\elim(A,B,f,h,a)$ takes $f : A \to B$ with
  $h : \Pi x:B. \Pi y:B. x = y$ and $a : \squash{A}$ to return a $B$.

  \section{Typing Rules}

  \begin{center}
  \(
    \ru{}{\der \cdot}
    \qquad
    \ru{\Gamma \der T : s \qquad
        x \notin \Gamma
      }{\der \Gamma, x : T}
    \qquad
    \ru{\der \Gamma
      }{\Gamma \der \Type_i : \Type_{i+1}}
    \qquad
    \ru{\der \Gamma \qquad
        (x : T) \in \Gamma
      }{\Gamma \der x : T}
  \)
  \end{center}

  \begin{center}
  \(
    \ru{\Gamma \der t : \Pi x:A.B \qquad
        \Gamma \der t' : A
      }{\Gamma \der t\ t' : B[t'/x]}
    \qquad
    \ru{\Gamma \der A : s \qquad
        \Gamma, x:A \der B : s' \qquad
        (s,s',s'') \in \R
      }{\Gamma \der \Pi x:A.B : s''}
  \)
  \end{center}

  \begin{center}
  \(
    \ru{\Gamma \der \Pi x:A.B : s \qquad
        \Gamma, x:A \der t : B
      }{\Gamma \der \lambda x:A.t : \Pi x:A.B}
    \qquad
    \ru{\Gamma \der t : \Sigma x:A.B
      }{\Gamma \der t.1 : A}
    \qquad
    \ru{\Gamma \der t : \Sigma x:A.B
      }{\Gamma \der t.2 : B[t.1/x]}
  \)
  \end{center}

  \begin{center}
  \(
    \ru{\Gamma \der A : s \qquad
        \Gamma, x:A \der B : s' \qquad
        (s,s',s'') \in \R
      }{\Gamma \der \Sigma x:A.B : s''}
    \qquad
    \ru{\Gamma \der T : s \qquad
        \Gamma \der t,t' : T
      }{\Gamma \der t =_T t' : s}
  \)
  \end{center}

  \begin{center}
  \(
    \ru{\Gamma \der t : A \qquad
        \Gamma \der t' : B[t/x] \qquad
        \Gamma \der \Sigma x:A.B : s
      }{\Gamma \der (t;t') : \Sigma x:A.B}
    \qquad
    \ru{\Gamma \der t : T
      }{\Gamma \der \refl_t : t =_T t}
  \)
  \end{center}

  \begin{center}
  \(
    \tru{\Gamma \der A : s \qquad
         \Gamma \der C : \Pi x:A. \Pi y:A. (x =_A y) \to s'
       }{\Gamma \der b : \Pi x:A. C\ x\ x\ \refl_x
       }{\Gamma \der u, v : A \qquad
         \Gamma \der p : u =_A v
       }{\Gamma \der \J (A,C,b,u,v,p) : C\ u\ v\ p}
  \)
  \end{center}

  \begin{center}
  \(
    \ru{\Gamma \der t : A \qquad
        \Gamma \der B : s \qquad
        \Gamma \der A \le B
      }{\Gamma \der t : B}
  \)
  \end{center}

  \noindent %
  Now, we consider our rules for squash (acting as a resizing rule!).

  \begin{center}
  \(
    \ru{\Gamma \der A : \Type_i
      }{\Gamma \der \squash{A} : \Type_0}
    \qquad
    \ru{\Gamma \der t : A
      }{\Gamma \der [t] : \squash{A}}
  \)
  \end{center}

  \begin{center}
  \(
    \ru{\Gamma \der f : A \to B \qquad
        \Gamma \der h : \Pi_{x:A} \Pi_{y:A} x = y \qquad
        \Gamma \der a : \squash{A}
      }{\Gamma \der \elim(A,B,f,h,a) : B}
  \)
  \end{center}

\end{document}
