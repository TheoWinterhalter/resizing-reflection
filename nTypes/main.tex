\documentclass[a4paper,english]{lipics-utf8x}

\usepackage[T1]{fontenc} %

\usepackage{amsmath, amssymb, amsfonts, stmaryrd}
\usepackage{pifont}
\PrerenderUnicode{é} % For the author names in the heading

% Add some colors
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage{hyperref}
\hypersetup{
 linktocpage,
 colorlinks,
 citecolor=BlueViolet,
 filecolor=red,
 linkcolor=Blue,
 urlcolor=BrickRed
}

\usepackage{graphicx}
\usepackage{placeins}

% Meta comment
\newcommand\meta[1]{\noindent\textcolor{blue}{\emph{#1}}}

% Include the macro file
\input{macros}

% Title and so...
\title{$n$-Types live a peaceful life without universes}
\author[1]{Théo Winterhalter}

\begin{document}

  \maketitle

  \begin{abstract}
    We'll try to define a system with no universe hierarchy but with
    $n$-Types, hopefully showing it's consistent and has a decidable type
    checking.
  \end{abstract}

  \section{Syntax}

  \[
    \begin{array}{l@{~}l@{~}l@{~}r@{~}l@{\quad}l}
      \Var  & \ni & x,y,X,Y \\
      \Exp  & \ni & t,u,T,U & ::= & \Pi x:U.T \mid \Sigma x:U.T \\
                         &&& \mid & x \mid \lambda x:U.t \mid t~u
                               \mid (t;u) \mid t.1 \mid t.2 \\
                         &&& \mid & {<} t {>} \mid {<} T ; t {>} \mid \ctr_t
                               \mid \pi_t \mid t \gettype \mid t \getproof \\
      \Ctx  & \ni & \Gamma  & ::= & \cdot \mid \Gamma, x:T \\
    \end{array}
  \]

  \section{Typing Rules}

  We give ourselves basic dependent type theory with $\Pi$-types and
  $\Sigma$-types, as well as the indentity types necessary to define the
  $n$-Types.
  This theory doesn't have the usual universes that one require to ensure
  consistency. The goal is to prove that they are unnecessary as long as you
  remain in the realm of $n$-Types (finite homotopy complexity).

  \begin{center}
  \(
    \ru{}{\der \cdot}
    \qquad
    \ru{\Gamma \der T \type \qquad
        x \notin \Gamma
      }{\der \Gamma, x : T}
    \qquad
    \ru{\der \Gamma \qquad
        (x : T) \in \Gamma
      }{\Gamma \der x : T}
  \)
  \end{center}

  \begin{center}
  \(
    \ru{\Gamma \der t : \Pi x:A.B \qquad
        \Gamma \der t' : A
      }{\Gamma \der t\ t' : B[t'/x]}
    \qquad
    \ru{\Gamma \der A \type \qquad
        \Gamma, x:A \der B \type
      }{\Gamma \der \Pi x:A.B \type}
  \)
  \end{center}

  \begin{center}
  \(
    \ru{\Gamma \der \Pi x:A.B : s \qquad
        \Gamma, x:A \der t : B
      }{\Gamma \der \lambda x:A.t : \Pi x:A.B}
    \qquad
    \ru{\Gamma \der t : \Sigma x:A.B
      }{\Gamma \der t.1 : A}
    \qquad
    \ru{\Gamma \der t : \Sigma x:A.B
      }{\Gamma \der t.2 : B[t.1/x]}
  \)
  \end{center}

  \begin{center}
  \(
    \ru{\Gamma \der t : A \qquad
        \Gamma \der t' : B[t/x]
      }{\Gamma \der (t ; t') : \Sigma x:A.B}
    \qquad
    \ru{\Gamma \der A \type \qquad
        \Gamma, x:A \der B \type
      }{\Gamma \der \Sigma x:A.B \type}
  \)
  \end{center}

  \begin{center}
  \(
    \ru{\Gamma \der T \type \qquad
        \Gamma \der t,t' : T
      }{\Gamma \der t =_T t' \type}
    \qquad
    \ru{\Gamma \der t : A
      }{\Gamma \der \refl_t : t =_T t}
  \)
  \end{center}

  \begin{center}
  \(
    \ru{\Gamma \der t : A \qquad
        \Gamma \der B \type \qquad
        \Gamma \der A = B
      }{\Gamma \der t : B}
  \)
  \end{center}

  \meta{TODO: Add an elimination rule for equality.}

  \noindent %
  We then add the rules regarding the $n$-Types, giving us base
  types.
  Basically we are defining types that couldn't be defined without
  quantification on a universe. Our purpose is then to prove
  that all of these $n$-Types can live in the smalleest universe:
  indeed, $\Gamma \der T \type$ can be seen as
  $\Gamma \der T : \Type_0$ in a PTS with smallest universe
  $\Type_0$.

  \begin{center}
  \(
    \ru{\Gamma \der T \type
      }{\Gamma \der \isnType{n}{T} \type}
    \qquad
    \ru{%\Gamma \der T \type \qquad
        \Gamma \der h : \Sigma x:T. \Pi y:T. x =_T y
      }{\Gamma \der {<} h {>} : \isnType{(-2)}{T}}
  \)
  \end{center}

  \begin{center}
  \(
    \ru{%\Gamma \der T \type \qquad
        \Gamma \der h : \Pi x:T. \Pi y:T. \isnType{n}{x =_T y}
      }{\Gamma \der {<} h {>} : \isnType{(n+1)}{T}}
  \)
  \end{center}

  \begin{center}
  \(
    \ru{\Gamma \der t : \isnType{(-2)}{T}
      }{\Gamma \der \ctr_t : \Sigma x:T. \Pi y:T. x =_T y}
    \qquad
    \ru{\Gamma \der t : \isnType{(n+1)}{T}
      }{\Gamma \der \pi_t : \Pi x:T. \Pi y:T. \isnType{n}{x =_T y}}
  \)
  \end{center}

  We also add $\nType{n}$ as a base type for quantification
  purposes. This is basically a $\Sigma$-type except that it is
  defined on the whole universe.

  \begin{center}
  \(
    \ru{}{\Gamma \der \nType{n} \type}
    \qquad
    \ru{\Gamma \der T \type \qquad
        \Gamma \der h : \isnType{n}{T}
      }{\Gamma \der {<} T ; h {>} : \nType{n}}
  \)
  \end{center}

  \begin{center}
  \(
    \ru{\Gamma \der t : \nType{n}
      }{\Gamma \der t \gettype \type}
    \qquad
    \ru{\Gamma \der t : \nType{n}
      }{\Gamma \der t \getproof : \isnType{n}{t \gettype}}
  \)
  \end{center}

  As one can guess, both $\ctr_{{<} h {>}}$ and $\pi_{{<}h{>}}$ reduce to $h$
  and $\_ \gettype$ and $\_ \getproof$ are respectively first and second
  projections.


% \section{Computation}
%
% We present weak-head reduction as follows:
%
% \begin{center}
% \(
%   \ru{t \rew f \qquad
%       f~u \rew a
%     }{t~u \rew a}
%   \qquad
%   \ru{}{a \rew a}
%   \qquad
%   \ru{t[u/x] \rew a
%     }{(\lambda x:U.t)~u \rew a}
%   \qquad
%   \ru{}{n~u \rew n~u}
%   \qquad
%   \ru{T \rew A
%     }{(\RRe{T}{h}).\type \rew A}
% \)
% \end{center}

\end{document}
